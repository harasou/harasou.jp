---
title: "continue: only meaningful in a `for', `while', or `until' loop"
date: 2021-02-11T09:21:23+09:00
tags:
  - linux
slug:           2021/02/11/bash-continue-error
thumbnailImage: 2021/02/11/bash-continue-error/bash.png
---

ä»¥å‰ã‹ã‚‰ä½¿ã„å›ã—ã¦ã„ãŸã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒã€continue æ™‚ã«ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹ã‚ˆã†ã«ãªã£ãŸã€‚

<!--more-->

```
#!/bin/bash

for i in 1 2 3
do
    {
        [ $i -eq 2 ] && continue
        echo $i
    } 2>&1 | tee $i.log
done
```

forãƒ«ãƒ¼ãƒ—ã§å—ã‘å–ã£ãŸå€¤ã”ã¨ã«ãƒ­ã‚°ã‚’åããŸã‹ã£ãŸã®ã ãŒã€continue ã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ğŸ˜“
å‡¦ç†ã‚‚ç¶™ç¶šã•ã‚Œã¦ã‚‹ã—...

```
# bash loop.sh
1
loop.sh: line 6: continue: only meaningful in a `for', `while', or `until' loop
2
3
```

åŸå› ã¯ subshell
-----------------------------------------------------------------------------------

åŸå› ã¯ã€ã‚µãƒ–ã‚·ã‚§ãƒ«ã®ä¸­ã§ continue ã—ã¦ãŸã‹ã‚‰ï¼ˆpipe ä½¿ã£ã¦ã‚‹ã®ã§ `{}` ã§ã‚‚ã‚µãƒ–ã‚·ã‚§ãƒ«ã«ãªã‚‹ï¼‰ã€‚
ãŸã ã€ä»¥å‰ä½¿ã£ã¦ã„ãŸ bash4ç³»ï¼Ÿã ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚‰ãªã„ã€‚

```
$ bash --version
GNU bash, version 4.3.48(1)-release (x86_64-pc-linux-gnu)

$ bash loop.sh
1
3
```

ä»Šå›ã‚¨ãƒ©ãƒ¼ã«ãªã£ãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯ä»¥ä¸‹ã€‚å‡¦ç†ã‚’ã‚³ãƒ³ãƒ†ãƒŠã§ã‚„ã‚‹ã‚ˆã†ã«ãªã£ã¦ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒä¸ŠãŒã£ãŸã“ã¨ã§
éäº’æ›ãŒå‡ºãŸã¿ãŸã„ã€‚

```
# bash --version
GNU bash, version 5.0.3(1)-release (x86_64-pc-linux-gnu)
```

å¯¾å‡¦
-----------------------------------------------------------------------------------

`{}` ä¸­ã§è‰²ã€…ãªå‡¦ç†ã‚’ã‚„ã£ã¦ã‚‹ã®ã§ã€ãã‚Œãã‚Œã®å‡¦ç†ã§ãƒ­ã‚°åãã®ã¯ã‚ã‚“ã©ãã•ã„ã€‚

ãƒ—ãƒ­ã‚»ã‚¹ç½®æ› `>()` ã‚„ `exec` ä½¿ã£ã¦ã€å‡ºåŠ›å…ˆã‚’å¤‰ãˆã‚ˆã†ã¨è©¦ã—ã¦ã¿ãŸã‘ã©ã€ã†ã¾ãã„ã‹ãªã‹ã£ãŸã€‚
ã‚³ãƒãƒ³ãƒ‰ãŒå…¥åŠ›å¾…ã¡ã«ãªã£ãŸã‚Šã€ãƒ­ã‚°ã®ä¸­èº«ãŒå¤‰ã«ãªã£ãŸã‚Šã€‚

```
#!/bin/bash

for i in 1 2 3
do
    {
        [ $i -eq 2 ] && continue
        echo $i
    } > >(tee $i.log) 2>&1
done
```
```
#!/bin/bash

for i in 1 2 3
do
    exec > >(tee $i.log)
    exec 2>&1

    [ $i -eq 2 ] && continue
    echo $i
done
```
çµå±€ã€ã‚µãƒ–ã‚·ã‚§ãƒ«ã®å¤–ã§ continue ã™ã‚‹ã“ã¨ã«ã€‚ã‚‚ã£ã¨ã‚·ãƒ³ãƒ—ãƒ«ãªæ–¹æ³•ã¯ãªã„ã‚“ã ã‚ã†ã‹...
```
#!/bin/bash

SKIP_CODE=127
for i in 1 2 3
do
    {
        [ $i -eq 2 ] && exit $SKIP_CODE
        echo $i
    } 2>&1 | tee $i.log

    [ ${PIPESTATUS[0]} -eq $SKIP_CODE ] && continue

    # skip ã—ãªã„æ™‚ã«å¿…è¦ãªå‡¦ç†
done
```



<!--links-->
